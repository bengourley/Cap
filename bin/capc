#!/usr/bin/env node

/**
 * Module dependencies.
 */

var program = require('commander'),
		createCompiler = require('../lib/compiler'),
		createCli = require('../lib/cli');

program
	.version('0.0.1')
	.option(
		'-t, --printtree',
		'print the syntax tree instead of compiling (forces --print)'
	)
	.option(
		'-p, --print',
		'print the output instead of writing to file'
	)
	.option(
		'-c, --compress',
		'compress the output'
	)
	.option(
		'-b, --browser',
		'bundle the compiled js into a single js file for use in the browser'
	)
  .option(
    '-f, --files',
    'compile only the given files',
    Array
  );

// Custom help
program.on('--help', function(){
  console.log('  Examples:');
  console.log('');
  console.log('    $ capc');
  console.log('');
  console.log('  |  Recursively scans the current directory and');
  console.log('  |  and compiles all the `.cap` files it finds');
  console.log('');
  console.log('    $ capc --browser app');
  console.log('');
  console.log('  |  Recursively scans the current directory and');
  console.log('  |  and compiles all the `.cap` files, bundling');
  console.log('  |  them into a single file `app.cap.js` with some');
  console.log('  |  boilerplate code that will make it run in the');
  console.log('  |  browser');
  console.log('');
  console.log('    $ capc -f example.cap');
  console.log('');
  console.log('  |  Compiles example.cap \u2192 example.cap.js');
  console.log('');
});

program.parse(process.argv);

// Run the cli with args
createCli(program).run();